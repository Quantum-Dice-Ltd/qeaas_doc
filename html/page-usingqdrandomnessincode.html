<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Quantum Dice QEaaS API: How to use Quantum Dice randomness in your own code</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<script type="text/javascript" src="darkmode_toggle.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="qd_logo.png"/></td>
  <td id="projectalign">
   <div id="projectname">Quantum Dice QEaaS API<span id="projectnumber">&#160;1.0.5</span>
   </div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('page-usingqdrandomnessincode.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">How to use Quantum Dice randomness in your own code</div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul>
  <li class="level1 empty">
    <ul>
      <li class="level2">
        <a href="#autotoc_md40">Using Quantum Dice randomness in C code</a>
      </li>
      <li class="level2">
        <a href="#autotoc_md41">Using Quantum Dice randomness in C++ code</a>
      </li>
      <li class="level2">
        <a href="#autotoc_md42">Using Quantum Dice randomness in python code</a>
        <ul>
          <li class="level3">
            <a href="#autotoc_md43">Use with numpy</a>
          </li>
        </ul>
      </li>
    </ul>
  </li>
</ul>
</div>
<div class="textblock"><h2><a class="anchor" id="autotoc_md40"></a>
Using Quantum Dice randomness in C code</h2>
<ol type="1">
<li>Use <code>qdremdemo_ce.c</code> as a starting point.</li>
<li><p class="startli">Include <a class="el" href="qdremrand_8h.html">qdremrand.h</a> and initialise the connection to the EaaS server with:</p>
<div class="fragment"><div class="line"><a class="code hl_struct" href="struct_q_d_r_e_m_r_a_n_d.html">QDREMRAND</a> qdr;</div>
<div class="line"><a class="code hl_namespace" href="namespaceqdremrand.html">qdremrand</a>(&amp;qdr);</div>
<div class="line"><span class="keywordflow">if</span> (<a class="code hl_function" href="qdremrand_8h.html#a12848803e115d9595f4154514aaf2e15">qdremrand_connect</a>(&amp;qdr, rem_host, rem_port, peer_cert, my_cert, my_key)) {</div>
<div class="line">        fprintf(stderr, <span class="stringliteral">&quot;Cannot connect to QD remote randomness\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">}</div>
<div class="ttc" id="anamespaceqdremrand_html"><div class="ttname"><a href="namespaceqdremrand.html">qdremrand</a></div><div class="ttdef"><b>Definition</b> qdremrand.py:1</div></div>
<div class="ttc" id="aqdremrand_8h_html_a12848803e115d9595f4154514aaf2e15"><div class="ttname"><a href="qdremrand_8h.html#a12848803e115d9595f4154514aaf2e15">qdremrand_connect</a></div><div class="ttdeci">int qdremrand_connect(QDREMRAND *qdr, const char *rem_host, const char *rem_port, const char *peer_cert_file, const char *my_chain_file, const char *my_key_file)</div><div class="ttdoc">Connects to the specified Quantum Dice randomness server.</div></div>
<div class="ttc" id="astruct_q_d_r_e_m_r_a_n_d_html"><div class="ttname"><a href="struct_q_d_r_e_m_r_a_n_d.html">QDREMRAND</a></div><div class="ttdoc">Structure to hold connection and state information.</div><div class="ttdef"><b>Definition</b> qdremrand.h:17</div></div>
</div><!-- fragment --></li>
<li><p class="startli">If you want metadata with your randomness, fetch it like this:</p>
<div class="fragment"><div class="line"><span class="keyword">struct </span><a class="code hl_struct" href="structqdrandom.html">qdrandom</a> randbuf[16];</div>
<div class="line">ssize_t got = <a class="code hl_function" href="qdremrand_8h.html#a5c7bf596ad4cec08bef2146aca556507">qdremrand_getrand_ce</a>(&amp;qdr, randbuf, ARRAY_SIZE(randbuf));</div>
<div class="line"><span class="keywordflow">if</span> (got == -1) {</div>
<div class="line">        fprintf(stderr, <span class="stringliteral">&quot;qdremrand_getrand_ce() failed\nCannot get random data\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">}</div>
<div class="ttc" id="aqdremrand_8h_html_a5c7bf596ad4cec08bef2146aca556507"><div class="ttname"><a href="qdremrand_8h.html#a5c7bf596ad4cec08bef2146aca556507">qdremrand_getrand_ce</a></div><div class="ttdeci">ssize_t qdremrand_getrand_ce(QDREMRAND *qdr, struct qdrandom *randbuf, size_t randlen)</div><div class="ttdoc">Retrieves random data with certification and entropy information from the Quantum Dice randomness ser...</div></div>
<div class="ttc" id="astructqdrandom_html"><div class="ttname"><a href="structqdrandom.html">qdrandom</a></div><div class="ttdoc">certified randomness</div><div class="ttdef"><b>Definition</b> qdremrand.h:99</div></div>
</div><!-- fragment --><p class="startli">or for just a stream of randomness, fetch it like this:</p>
<div class="fragment"><div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> rands[16000];</div>
<div class="line">    ssize_t got = <a class="code hl_function" href="qdremrand_8h.html#a3861acc7f7436b8704825f866125e148">qdremrand_getrand</a>(&amp;qdr, rands, <span class="keyword">sizeof</span>(rands));</div>
<div class="line">    <span class="keywordflow">if</span> (got == -1) {</div>
<div class="line">            fprintf(stderr, <span class="stringliteral">&quot;qdremrand_getrand() failed\nCannot get random data\n&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="ttc" id="aqdremrand_8h_html_a3861acc7f7436b8704825f866125e148"><div class="ttname"><a href="qdremrand_8h.html#a3861acc7f7436b8704825f866125e148">qdremrand_getrand</a></div><div class="ttdeci">ssize_t qdremrand_getrand(QDREMRAND *qdr, unsigned char *randbuf, size_t randlen)</div><div class="ttdoc">Retrieves random data from the Quantum Dice randomness server.</div></div>
</div><!-- fragment --></li>
</ol>
<h2><a class="anchor" id="autotoc_md41"></a>
Using Quantum Dice randomness in C++ code</h2>
<p>You can use the demo programs to see how you can use the randomness in your own code.</p>
<ol type="1">
<li><p class="startli">In qdremdemo.cpp it initialises the connection to the EaaS server with:</p>
<div class="fragment"><div class="line"><a class="code hl_class" href="class_qdremrand.html">Qdremrand</a> qdr;</div>
<div class="line"><span class="keywordflow">if</span> (qdr.<a class="code hl_function" href="class_qdremrand.html#a4503f5560d79a9ac379c4a68929d7573">connect</a>(rem_host, rem_port, peer_cert, my_cert, my_key)) {</div>
<div class="line">        std::cerr &lt;&lt; <span class="stringliteral">&quot;Cannot connect to QD remote randomness\n&quot;</span>;</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">}</div>
<div class="ttc" id="aclass_qdremrand_html"><div class="ttname"><a href="class_qdremrand.html">Qdremrand</a></div><div class="ttdoc">C++ wrapper class for the QDREMRAND functionality.</div><div class="ttdef"><b>Definition</b> qdremrand.h:166</div></div>
<div class="ttc" id="aclass_qdremrand_html_a4503f5560d79a9ac379c4a68929d7573"><div class="ttname"><a href="class_qdremrand.html#a4503f5560d79a9ac379c4a68929d7573">Qdremrand::connect</a></div><div class="ttdeci">int connect(const char *rem_host, const char *rem_port, const char *peer_cert_file, const char *my_chain_file, const char *my_key_file)</div><div class="ttdef"><b>Definition</b> qdremrand.h:171</div></div>
</div><!-- fragment --><p class="startli">and gets blocks of random bytes with:</p>
<div class="fragment"><div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> randbuf[64000];</div>
<div class="line">    ssize_t got = qdr.<a class="code hl_function" href="class_qdremrand.html#af6ea9765138ab65aeee2223d439b607a">getrand</a>(randbuf, <span class="keyword">sizeof</span>(randbuf));</div>
<div class="line">    <span class="keywordflow">if</span> (got == -1) {</div>
<div class="line">            fprintf(stderr, <span class="stringliteral">&quot;getrand() failed\nCannot get random data\n&quot;</span>);</div>
<div class="line">    ...</div>
<div class="ttc" id="aclass_qdremrand_html_af6ea9765138ab65aeee2223d439b607a"><div class="ttname"><a href="class_qdremrand.html#af6ea9765138ab65aeee2223d439b607a">Qdremrand::getrand</a></div><div class="ttdeci">ssize_t getrand(unsigned char *randbuf, size_t randlen)</div><div class="ttdef"><b>Definition</b> qdremrand.h:179</div></div>
</div><!-- fragment --></li>
<li><p class="startli">qdremdemo_norm.cpp sets up a distribution with:</p>
<div class="fragment"><div class="line"><a class="code hl_class" href="class_qdremrand.html">Qdremrand</a> qdr;</div>
<div class="line"><span class="keywordflow">if</span> (qdr.<a class="code hl_function" href="class_qdremrand.html#a4503f5560d79a9ac379c4a68929d7573">connect</a>(rem_host, rem_port, peer_cert, my_cert, my_key)) {</div>
<div class="line">        std::cerr &lt;&lt; <span class="stringliteral">&quot;Cannot connect to QD remote randomness\n&quot;</span>;</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">}</div>
<div class="line">Filerand&lt;uint_fast32_t&gt; qd_gen(&amp;qdr);</div>
<div class="line">std::normal_distribution norm(42.0, 5.0);</div>
</div><!-- fragment --><p class="startli">and then fetches and prints each value with:</p>
<div class="fragment"><div class="line">std::cout &lt;&lt; norm(qd_gen) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
</div><!-- fragment --></li>
</ol>
<p>You can get all the distributions of random numbers specified in the C++ programming language standard this way.</p>
<h2><a class="anchor" id="autotoc_md42"></a>
Using Quantum Dice randomness in python code</h2>
<p>The <a class="el" href="qdremrand_8py.html" title="Quantum Dice Remote Randomness Python Client.">qdremrand.py</a> file is the python module that you can import in your own code to access the server. For python's standard built-in functions for random distributions, use it like this:</p>
<div class="fragment"><div class="line"><span class="keyword">import</span> qdremrand</div>
<div class="line"> </div>
<div class="line">...</div>
<div class="line">qrn = <a class="code hl_class" href="classqdremrand_1_1_q_d_rem_rand.html">qdremrand.QDRemRand</a>(host, int(port), srvcert, clicert, clikey)</div>
<div class="line"><span class="keywordflow">and</span> you can get all the standard randomness functionality <span class="keyword">from</span> qrn.</div>
<div class="ttc" id="aclassqdremrand_1_1_q_d_rem_rand_html"><div class="ttname"><a href="classqdremrand_1_1_q_d_rem_rand.html">qdremrand.QDRemRand</a></div><div class="ttdoc">QdremrandPyClient (Quantum Dice Remote Random) is a custom random number generator that extends Pytho...</div><div class="ttdef"><b>Definition</b> qdremrand.py:16</div></div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md43"></a>
Use with numpy</h3>
<p>For use with numpy, instead of using:</p>
<div class="fragment"><div class="line">npg = numpy.random.default_rng()</div>
</div><!-- fragment --><p>use:</p>
<div class="fragment"><div class="line"><span class="keyword">from</span> randomgen <span class="keyword">import</span> UserBitGenerator</div>
<div class="line"><span class="keyword">import</span> numpy</div>
<div class="line"><span class="keyword">import</span> qdremrand</div>
<div class="line">...</div>
<div class="line">qdr = <a class="code hl_class" href="classqdremrand_1_1_q_d_rem_rand.html">qdremrand.QDRemRand</a>(host, int(port), srvcert, clicert, clikey)</div>
<div class="line">qd_ubg = UserBitGenerator(qdr.randint_64, 64, next_32=qdr.randint_32)</div>
<div class="line">npg = numpy.random.Generator(qd_ubg)</div>
</div><!-- fragment --><p>and you can use npg as usual. One big difference is that parallelism is much simpler. You can create multiple connections to the Quantum Dice server and use them in parallel with no need to worry about using different seeds or skipping ahead to avoid duplicate random numbers. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0 </li>
  </ul>
</div>
</body>
</html>
